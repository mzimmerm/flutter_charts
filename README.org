#+OPTIONS: toc:3
#+TODO: TODO IN-PROGRESS LATER DONE NOTE

* Table of contents :TOC:noexport:
- [[#internal-note-convert-all-images-to-width150][Internal note: convert all images to width=150]]
- [[#examples-with-code][Examples with code]]
  - [[#ex10randomdata_linechart-ex10randomdata_linechart][ex10RandomData_lineChart <<ex10RandomData_lineChart>>]]
- [[#latest-release-changes][Latest release changes]]
  - [[#illustration-of-a-new-feature-ability-to-hide-labels-legend-or-gridlines][Illustration of a new feature: ability to hide labels, legend, or gridlines]]
- [[#installation][Installation]]
  - [[#installing-flutter_charts-as-a-library-package-into-your-app][Installing flutter_charts as a library package into your app]]
  - [[#installing-the-flutter_charts-project-as-a-local-clone-from-github][Installing the flutter_charts project as a local clone from Github]]
- [[#running-the-examples-included-in-flutter_charts][Running the examples included in flutter_charts]]
- [[#old-examples-with-code-linechart-and-verticalbarchart-code-and-resulting-charts][Old Examples with code: LineChart and VerticalBarChart. Code and resulting charts]]
  - [[#example-with-random-data-y-values-random-x-labels-random-colors-random-data-rows-legends-data-generated-y-labels][Example with Random Data (Y values), Random X Labels, Random Colors, Random Data Rows Legends, Data-Generated Y Labels.]]
  - [[#user-provided-data-y-values-user-provided-x-labels-random-colors-user-provided-data-rows-legends-data-generated-y-labels][User-Provided Data (Y values), User-Provided X Labels, Random Colors, User-Provided Data Rows Legends, Data-Generated Y Labels,]]
  - [[#user-provided-data-y-values-user-provided-x-labels-random-colors-user-provided-data-rows-legends-user-provided-y-labels][User-Provided Data (Y values), User-Provided X Labels, Random Colors, User-Provided Data Rows Legends, User-Provided Y Labels]]
  - [[#verticalbar-chart---one-more-example-showing-positivenegative-stacks][VerticalBar Chart - one more example, showing positive/negative stacks:]]
- [[#illustration-of-the-iterative-auto-layout-feature][Illustration of the "iterative auto layout" feature]]
  - [[#autolayout-step-1][Autolayout step 1]]
  - [[#autolayout-step-2][Autolayout step 2]]
  - [[#autolayout-step-3][Autolayout step 3]]
  - [[#autolayout-step-4][Autolayout step 4]]
  - [[#autolayout-step-5][Autolayout step 5]]
- [[#known-packages-libraries-and-apps-that-use-this-flutter_charts-package][Known packages, libraries and apps that use this flutter_charts package]]
- [[#todos][Todos]]

* Internal note: convert all images to width=150

#+begin_src bash :results output raw :eval no-export
  for file in doc/readme_images/ex*; do
      rm $file
  done
  for file in integration_test/screenshots_expected/ex*; do
      cp $file doc/readme_images
  done
  for file in doc/readme_images/ex*; do
      copy_name="$(basename $file)"
      copy_name="${copy_name/%.*/}"
      convert  $file -resize 150 $(dirname $file)/${copy_name}_w150.png
  done
#+end_src

#+RESULTS:

* IN-PROGRESS Examples with code


| [[ex10RandomData_lineChart][file:doc/readme_images/ex10RandomData_verticalBarChart_w150.png]  |   |


 [[ex10RandomData_lineChart][file:doc/readme_images/ex10RandomData_verticalBarChart_w150.png]


** ex10RandomData_lineChart <<ex10RandomData_lineChart>>

Code

#+begin_src dart
  Widget chartToRun() {
    LabelLayoutStrategy? xContainerLabelLayoutStrategy;
    ChartData chartData;
    ChartOptions chartOptions = const ChartOptions();

    // code from switch
    chartData = RandomChartData.generated(chartOptions: chartOptions);

    // code at the end.
    // If lineChart, show this
    var lineChartContainer = LineChartTopContainer(
      chartData: chartData,
      xContainerLabelLayoutStrategy: xContainerLabelLayoutStrategy,
    );

    var lineChart = LineChart(
      painter: LineChartPainter(
        lineChartContainer: lineChartContainer,
      ),
    );
    return lineChart;
    }

    // If verticalBarChart, show this
    var verticalBarChartContainer = VerticalBarChartTopContainer(
      chartData: chartData,
      xContainerLabelLayoutStrategy: xContainerLabelLayoutStrategy,
    );

    var verticalBarChart = VerticalBarChart(
      painter: VerticalBarChartPainter(
        verticalBarChartContainer: verticalBarChartContainer,
      ),
    );

    return verticalBarChart;
  }

#+end_src

Result

#+CAPTION: Line Chart caption
#+ATTR_ORG: :width 300
#+ATTR_LATEX: :width 2.0in
#+ATTR_HTML: :width 300
[[file:doc/readme_images/ex10RandomData_verticalBarChart.png]]


* Latest release changes

The latest release is 0.3.0

The file:CHANGELOG.md document describes features and bug fixes in this and older versions.

** Illustration of a new feature: ability to hide labels, legend, or gridlines

Code is for the line chart. See the function ~Widget createRequestedChart()~ in https://github.com/mzimmerm/flutter_charts/blob/master/example1/lib/main.dart for changes to create a vertical bar chart instead (essentially in this code substitute "Line" for "VerticalBar". For the configuration, the section of interest is around ~ExamplesEnum.ex31AnimalsBySeasonNoLabelsShown~

#+BEGIN_SRC dart
  // This is how noLabels can be set. See the previous section for a fine control of this option
  ChartOptions  chartOptions = LineChartOptions.noLabels(); 
  ChartData  chartData = ChartData();
  chartData.dataRowsLegends = [
    'Spring',
    'Summer',
    'Fall',
    'Winter',
  ];
  chartData.dataRows = [
    [10.0, 20.0, 5.0, 30.0, 5.0, 20.0],
    [30.0, 60.0, 16.0, 100.0, 12.0, 120.0],
    [25.0, 40.0, 20.0, 80.0, 12.0, 90.0],
    [12.0, 30.0, 18.0, 40.0, 10.0, 30.0],
  ];
  chartData.xLabels = ['Wolf', 'Deer', 'Owl', 'Mouse', 'Hawk', 'Vole'];
  chartData.assignDataRowsDefaultColors();

  // This section is shown repeatedly in all examples, to stress how charts are created
  LineChartTopContainer lineChartContainer = LineChartTopContainer(
    chartData: chartData,
    chartOptions: chartOptions,
    xContainerLabelLayoutStrategy: xContainerLabelLayoutStrategy,
  );

  LineChart lineChart = LineChart(
    painter: LineChartPainter(
      lineChartContainer: lineChartContainer,
    ),
  );
#+END_SRC

The ~lineChart~ widget can be placed on any Flutter app. The example code is in https://github.com/mzimmerm/flutter_charts/blob/master/example1/lib/main.dart

Result line chart:

#+CAPTION: Line Chart caption
#+ATTR_ORG: :width 300
#+ATTR_LATEX: :width 2.0in
#+ATTR_HTML: :width 300
[[file:doc/readme_images/ex31AnimalsBySeasonNoLabelsShown_lineChart.png]]

Result vertical bar chart:

#+NAME: fig:Vertical Bar Chart
#+CAPTION: Vertical Bar Chart caption
#+ATTR_ORG: :width 300
#+ATTR_LATEX: :width 2.0in
#+ATTR_HTML: :width 300
[[file:doc/readme_images/ex31AnimalsBySeasonNoLabelsShown_verticalBarChart.png]]

* Installation
** Installing flutter_charts as a library package into your app

If you want to use the ~flutter_charts~ library package in your app, please follow instructions in https://pub.dev/packages/flutter_charts/install. This will result in ability of your app to use  ~flutter_charts~.

** Installing the flutter_charts project as a local clone from Github

The advantage of installing the source of the ~flutter_charts~ project locally from Github is that you can run the packaged example application and also run the integration and widget tests.

To install (clone) the ~flutter_charts~ project from Github to your local system, follow these steps:

- Install Flutter, and items such as Android emulator. Instructions are on the Flutter website https://docs.flutter.dev/get-started/install.
- Go to https://github.com/mzimmerm/flutter_charts, click on the "Code" button, and follow the instuctions to checkout flutter_charts. A summary of one installation method (download method):
- Click the "Download zip" link https://github.com/mzimmerm/flutter_charts/archive/refs/heads/master.zip
- When prompted, save the file ~flutter_charts-master.zip~ one level above where you want the project. We will use ~$HOME/dev~
- Unzip the file ~flutter_charts-master.zip~
- The project will be in the ~$HOME/dev/flutter_charts-master/~ directory

* Running the examples included in flutter_charts

This section assumes you installed the flutter_charts project as a local clone from Github, as described in [[*Running the examples included in flutter_charts]]

There is an example application in flutter_charts: ~example1/lib/main.dart~. It shows how the Flutter Charts library can be included in a Flutter application.

To run the example application, Android emulator or iOS emulator need to be installed. You can use an IDE or command line. Instructions here are for the command line. Start in the unzipped directory, and follow the steps below:

- Important: Make sure an Android or iOS emulator is running, or you have a physical device connected. See the [[*Installing the flutter_charts project as a local clone from Github]] section.
- ~cd $HOME/dev/flutter_charts-master/~  
- Paste any of the lines below to the command line.
  - To run one example (actually two, first line chart, next vertical bar chart), run:
    #+begin_src bash
      tool/demo/run_all_examples.sh ex10RandomData
    #+end_src
    (press q in the terminal to quit the current example and run next)
  - To run all examples 
    #+begin_src bash
      tool/demo/run_all_examples.sh
    #+end_src
    (press q in the terminal to quit the current example and run next)

Sample screenshot from running the example app

#+NAME: fig:Line Chart
#+CAPTION: Line Chart caption
#+ATTR_ORG: :width 300
#+ATTR_LATEX: :width 2.0in
#+ATTR_HTML: :width 300
[[file:doc/readme_images/ex10RandomData_lineChart.png]]

* Old Examples with code: LineChart and VerticalBarChart. Code and resulting charts

Flutter Charts code allow to define the following data elements:

| /Data (Y values)/          | User-Provided or Random         |
| /X Labels/                 | User-Provided or Random         |
| /Options including Colors/ | User-Provided or Random         |
| /Data Rows Legends/        | User-Provided or Random         |
| /Y Labels/                 | User-Provided or Data-Generated |

The examples below show a few alternative code snippets (User-Provided or Random data, labels, option) and the resulting charts.

See the section [[*Running the examples included in flutter_charts]] on how to run the code that created the images below.  The code snippets are from the method ~Widget createRequestedChart()~ in ~example1/lib/main.dart~ 

** Example with Random Data (Y values), Random X Labels, Random Colors, Random Data Rows Legends, Data-Generated Y Labels.

This example shows that Data-Generated Y labels are default. Flutter Charts support reasonably intelligently generated Y Labels from data, including dealing with negatives.

Code is for line chart. See the function ~Widget createRequestedChart()~ in https://github.com/mzimmerm/flutter_charts/blob/master/example1/lib/main.dart for changes to create a vertical bar chart instead (essentially in this code substitute "Line" for "VerticalBar".

#+BEGIN_SRC dart
  ChartOptions chartOptions = LineChartOptions();  
  ChartData chartData = RandomChartData();

  // This section is shown repeatedly in all examples, to stress how charts are created
  LineChartTopContainer lineChartContainer = LineChartTopContainer(
    chartData: chartData,
    chartOptions: chartOptions,
    xContainerLabelLayoutStrategy: xContainerLabelLayoutStrategy,
  );

  LineChart lineChart = LineChart(
    painter: LineChartPainter(
      lineChartContainer: lineChartContainer,
    ),
  );
#+END_SRC

The ~lineChart~ widget can be placed on any Flutter app. The example code is in https://github.com/mzimmerm/flutter_charts/blob/master/example1/lib/main.dart

Result line chart:

#+CAPTION: Line Chart caption
#+ATTR_ORG: :width 300
#+ATTR_LATEX: :width 2.0in
#+ATTR_HTML: :width 300
[[file:doc/readme_images/ex10RandomData_lineChart.png]]

Result vertical bar chart:

#+NAME: fig:Vertical Bar Chart
#+CAPTION: Vertical Bar Chart caption
#+ATTR_ORG: :width 300
#+ATTR_LATEX: :width 2.0in
#+ATTR_HTML: :width 300
[[file:doc/readme_images/ex10RandomData_verticalBarChart.png]]

** User-Provided Data (Y values), User-Provided X Labels, Random Colors, User-Provided Data Rows Legends, Data-Generated Y Labels,

Code is for line chart. See the function ~Widget createRequestedChart()~ in https://github.com/mzimmerm/flutter_charts/blob/master/example1/lib/main.dart for changes to create a vertical bar chart instead (essentially in this code substitute "Line" for "VerticalBar". Section ~ExamplesEnum.ex30AnimalsBySeasonWithLabelLayoutStrategy_lineChart.png~

#+BEGIN_SRC dart
  ChartOptions chartOptions = LineChartOptions();  
  LabelLayoutStrategy xContainerLabelLayoutStrategy = DefaultIterativeLabelLayoutStrategy(
    options: chartOptions,
  );
  ChartData  chartData = ChartData();
  chartData.dataRowsLegends = [
    'Spring',
    'Summer',
    'Fall',
    'Winter',
  ];
  chartData.dataRows = [
    [10.0, 20.0, 5.0, 30.0, 5.0, 20.0],
    [30.0, 60.0, 16.0, 100.0, 12.0, 120.0],
    [25.0, 40.0, 20.0, 80.0, 12.0, 90.0],
    [12.0, 30.0, 18.0, 40.0, 10.0, 30.0],
  ];
  chartData.xLabels = ['Wolf', 'Deer', 'Owl', 'Mouse', 'Hawk', 'Vole'];
  chartData.assignDataRowsDefaultColors();
  
  // This section is shown repeatedly in all examples, to stress how charts are created
  LineChartTopContainer lineChartContainer = LineChartTopContainer(
    chartData: chartData,
    chartOptions: chartOptions,
    xContainerLabelLayoutStrategy: xContainerLabelLayoutStrategy,
  );

  LineChart lineChart = LineChart(
    painter: LineChartPainter(
      lineChartContainer: lineChartContainer,
    ),
  );
#+END_SRC

The ~lineChart~ widget can be placed on any Flutter app. The example code is in https://github.com/mzimmerm/flutter_charts/blob/master/example1/lib/main.dart

Result line chart:

#+CAPTION: Line Chart caption
#+ATTR_ORG: :width 300
#+ATTR_LATEX: :width 2.0in
#+ATTR_HTML: :width 300
[[file:doc/readme_images/ex30AnimalsBySeasonWithLabelLayoutStrategy_lineChart.png]]

Result vertical bar chart:

#+NAME: fig:Vertical Bar Chart
#+CAPTION: Vertical Bar Chart caption
#+ATTR_ORG: :width 300
#+ATTR_LATEX: :width 2.0in
#+ATTR_HTML: :width 300
[[file:doc/readme_images/ex30AnimalsBySeasonWithLabelLayoutStrategy_verticalBarChart.png]]


** User-Provided Data (Y values), User-Provided X Labels, Random Colors, User-Provided Data Rows Legends, User-Provided Y Labels

This example show how to use the option ~useUserProvidedYLabels~, and scaling of data to the Y labels range.

For code, please refer to the function ~Widget createRequestedChart()~ in https://github.com/mzimmerm/flutter_charts/blob/master/example1/lib/main.dart, section ~ExamplesEnum.ex40LanguagesWithYOrdinalUserLabelsAndUserColors~

#+CAPTION: Line Chart caption
#+ATTR_ORG: :width 300
#+ATTR_LATEX: :width 2.0in
#+ATTR_HTML: :width 300
[[file:doc/readme_images/ex40LanguagesWithYOrdinalUserLabelsAndUserColors_lineChart.png]]

** VerticalBar Chart - one more example, showing positive/negative stacks:

*** User-Provided Data (Y values), User-Provided X Labels, User-Provided Colors, User-Provided Data Rows Legends, User-Provided Y Labels

This example has again user defined Y Labels, with a bar chart, using the smart auto-layout of user defined Y Labels. The chart shows negative and positive values similar to %down/%up stock charts.


For code, please refer to the function ~Widget createRequestedChart()~ in https://github.com/mzimmerm/flutter_charts/blob/master/example1/lib/main.dart, section ~ExamplesEnum.ex50StocksWithNegativesWithUserColors~

#+CAPTION: Line Chart caption
#+ATTR_ORG: :width 300
#+ATTR_LATEX: :width 2.0in
#+ATTR_HTML: :width 300
[[file:doc/readme_images/ex50StocksWithNegativesWithUserColors_verticalBarChart.png]]

(there is a bug here,see Known Bugs)

* Illustration of the "iterative auto layout" feature

This section illustrates how the auto layout behaves when less and less horizontal space is available to display the chart. 

Flutter chart library automatically checks for the X label overlap, and follows with rule-based iterative re-layout, to prevent labels running into each other.

To illustrate "stressed" horizontal space for the chart, we are gradually adding a text widget containing and increasing number of '<' characters on the right of the chart.

** Autolayout step 1

Let's say there are six labels on a chart, and there is sufficient space to display labels horizontally. The result may look like this:
We can see all x axis labels displayed it full, horizontally oriented.

[[file:doc/readme_images/README.org_iterative-layout-step-1.png]]

** Autolayout step 2

Next, let us make less available space by taking away some space on the right with a wider text label such as '<<<<<<'
We can see the labels were automatically tilted by the angle ~LabelLayoutStrategy.labelTiltRadians~ for the labels to fit.

[[file:doc/readme_images/README.org_iterative-layout-step-2.png]]

** Autolayout step 3
Next, let us make even less available space by taking away some space on the right with a wider text label such as '<<<<<<<<<<<'.
We can see that labels are not only tilted, but also automatically skipped for labels not to overlap (every 2nd label is skipped, see option ~ChartOptions.iterativeLayoutOptions.showEveryNthLabel~).

[[file:doc/readme_images/README.org_iterative-layout-step-3.png]]

** Autolayout step 4

Next, let us make even less available space some more compared to step 3, with even a wider text label such as '<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<'.
We can see even more labels were skipped for labels to prevent overlap, the chart is showing every 5th label.

[[file:doc/readme_images/README.org_iterative-layout-step-4.png]]

** Autolayout step 5

Last, let us take away extreme amount of horizontal space by using '<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<',
Here we can see the "default auto layout" finally gave up, and overlaps labels. Also, the legend is now hidded, as the amount of horizontal space is not sufficient.

[[file:doc/readme_images/README.org_iterative-layout-step-5.png]]

* Known packages, libraries and apps that use this flutter_charts package

1. Michael R. Fairhurst's *Language reader app* - see https://github.com/MichaelRFairhurst/flutter-language-reader-app


* TODO Todos

1. [X] During construction of DataRows, enforce default values of Legend names and colors for rows. This fixes issues such as https://github.com/mzimmerm/flutter_charts/issues/18, when users do not set them and expect (reasonably) a default chart to show anyway.
2. [ ] Replace `reduce(fn)` with `fold(initialValue, fn)` throughout code to deal with exceptions when lists are empty. 
3. [X] Allow scaling y values using a function.
